<div class="panel">
    <h3>Rechercher</h3>
    <http-search url="{{ctrl.searchUrl}}" ng-model="ctrl.searchString"></http-search>
    <button class="btn btn-success pull-right" ng-click="ctrl.search()">Afficher</button>
</div>
<button type="button" ng-if="ctrl.user_is_admin" class="btn btn-success" ng-click="ctrl.create_new()">Nouveau</button>
<hr />
<div ng-class="{'col-lg-6': ctrl.searchResults.length, 'col-lg-12': !ctrl.searchResults.length}" ng-if="ctrl.editing" ng-include="'/static/js/templates/annuaire/form.htm'">
</div>

<div class="col-lg-6" ng-if="ctrl.showing" ng-include="'/static/js/templates/annuaire/show.htm'">
</div>
<div ng-class="{'col-lg-12': !(ctrl.editing || ctrl.showing), 'col-lg-6': (ctrl.editing || ctrl.showing)}" ng-if="ctrl.searchResults.length">
    <div class="panel panel-primary"> 
        <div class="panel-heading">
            <div class="panel-title">Resultats de la recherche</div>
        </div>
        <div class="panel-content">
            <p class="form">Résultats affichés : 
                <input type="checkbox" ng-model="ctrl.types_shown.correspondant">Correspondants -- 
                <input type="checkbox" ng-model="ctrl.types_shown.entite">Groupes -- 
                <input type="checkbox" ng-model="ctrl.types_shown.commune">Communes
            </p>
            <table class="table table-striped table-bordered">
                <tr>
                    <th>Nom</th>
                    <th>N° de téléphone</th>
                    <th>Adresse email</th>
                </tr>
                <tr ng-repeat="item in ctrl.searchResults" ng-if="ctrl.types_shown[item.type_entite]" ng-click="ctrl.show(item)">
                    <td>{{item.label}}</td>
                    <td>{{item.telephone}}</td>
                    <td><a ng-href="mailto:{{item.email}}" ng-click="ctrl.cancel_event($event)">{{item.email}}</a></td>
                </tr>
            </table>
        </div>
    </div>
</div>
